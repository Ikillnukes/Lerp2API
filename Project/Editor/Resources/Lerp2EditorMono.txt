#if UNITY_EDITOR

using System;
using System.Collections.Generic;
using UnityEditor;
using UnityEngine;

[ExecuteInEditMode]
public class Lerp2EditorMono : MonoBehaviour
{
    public static Lerp2EditorMono me;
    public Type[] childrens;
    public static List<Type> typeList = new List<Type>();
    public Lerp2EditorMono(Type[] ch)
    {
        if(ch != null)
            childrens = ch;
    }
    public void Start()
    {
        if (!EditorApplication.isPlayingOrWillChangePlaymode)
        {
            me = this;
            GameObject lerp2core = GameObject.Find("Lerp2Core"); //This is not allowed
            if (lerp2core == null)
            {
                GameObject go = new GameObject("Lerp2Core");
                go.AddComponent<Lerp2EditorMono>();
                if (childrens != null)
                    foreach (Type mono in childrens)
                        go.AddComponent(mono);
            }
        }
    }
    public static Lerp2EditorMono CreateInstance(Type[] types)
    {
        Lerp2EditorMono core = new Lerp2EditorMono(types);
        core.Start();
        return core;
    }
    public static Lerp2EditorMono GetInstance()
    {
        if (me == null)
            Debug.LogWarning("'Lerp2EditorMono' instance is null.");
        return me;
    }
    public static void AddElement<T>() where T : MonoBehaviour
    {
        if(typeList.Contains(typeof(T)))
        {
            Debug.LogError("This script already exists in 'Lerp2EditorMono'.");
            return;
        }
        typeList.Add(typeof(T));
        if (me != null)
            DestroyImmediate(me);
        Lerp2EditorMono ins = CreateInstance(typeList.ToArray());
    }
}

#endif